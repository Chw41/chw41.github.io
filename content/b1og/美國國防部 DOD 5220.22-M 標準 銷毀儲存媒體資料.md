---
title: "ç¾åœ‹åœ‹é˜²éƒ¨ DOD 5220.22-M æ¨™æº– éŠ·æ¯€å„²å­˜åª’é«”è³‡æ–™"
date: 2026-01-19
author: "CHW"
tags:
  - infra
description: "ä¾æ“š DOD 5220.22-M èˆ‡ NIST 800-88 æ¨™æº–ï¼ŒæŠ¹é™¤/éŠ·æ¯€ å„²å­˜ç¡¬ç¢Ÿæ–¹æ³•"
---

ä¾æ“šç¾åœ‹åœ‹é˜²éƒ¨ DOD 5220.22-M æ¨™æº– éŠ·æ¯€å„²å­˜åª’é«”è³‡æ–™
===


## Table of Contents

[TOC]


>[!Note]
> åˆ©ç”¨ SystemRescue è£½ä½œ USB é–‹æ©Ÿç¢Ÿé€²è¡ŒæŠ¹é™¤\
>Official Doucument:\
>https://www.system-rescue.org/ \
>![image](https://hackmd.io/_uploads/HkeOgVjHWl.png)


## 1. è£½ä½œ wipe é–‹æ©Ÿç¢Ÿ
- æŸ¥çœ‹éœ€è¦è£½ä½œçš„ USB ç¡¬ç¢Ÿç·¨è™Ÿï¼š
```
diskutil list
```

- å¸è¼‰ USB
```
diskutil unmountDisk /dev/<disk name>
```
- æ ¼å¼åŒ– USB
```
diskutil eraseDisk FAT32 MYDISK MBRFormat /dev/<disk name>
```
- ä¸‹è¼‰ SystemRescue Image
Image: https://www.system-rescue.org/Download/ \
![image](https://hackmd.io/_uploads/BycqzNsBWe.png)

## 2. å°‡ image ç‡’éŒ„è‡³ USB  
>[!Tip]
>å°‡ SystemRescue Image å¯«å…¥ USB

å„ç³»çµ±ç‡’éŒ„ image å·¥å…·ï¼š
### 2.1 Linux
linux å¯é€é `dd` å¯«å…¥
```
sudo dd if="<systemrescue.iso PATH>" of=/dev/<disk name> bs=4m conv=sync,noerror status=progress
```
> status=progress é¡¯ç¤ºå¯«å…¥é€²åº¦

```
sync
diskutil eject /dev/<disk name>
```
ç¢ºä¿è³‡æ–™å®Œå…¨å¯«å…¥å¾Œï¼Œå†æ‹”é™¤ USB

### 2.2 MacOS
MacOS å¯é€é [balenaEtcher](https://github.com/balena-io/etcher) ç‡’éŒ„

![image](https://hackmd.io/_uploads/rJHn44oB-e.png)


### 2.3 Windows
Windows å¯åˆ©ç”¨ [Rufus](https://rufus.ie/) ç‡’éŒ„

![image](https://hackmd.io/_uploads/HyZm04iHbe.png)
> - Partition scheme é¸æ“‡ `MBR` åŒæ™‚ç›¸å®¹ BIOS å’Œ UEFI
> - Target: `BIOS or UEFI`
> - Filesystem é¸æ“‡ `FAT32` (UEFI å•Ÿå‹•éç¨‹åƒ…é©ç”¨æ–¼ FAT æª”æ¡ˆç³»çµ±)

## 3. å•Ÿç”¨ SystemRescue
é–‹æ©Ÿé€²å…¥ BIOS é¸æ“‡ä½¿ç”¨ HardDisk (USB) é–‹æ©Ÿï¼Œé€²å…¥ SystemRescue é–‹æ©Ÿé¸å–®
### 3.1 é¸æ“‡ Boot SystemRescue using default options
é¸æ“‡ Boot SystemRescue using default options é€²å…¥é è¨­é–‹æ©Ÿæ¨¡å¼ï¼š
![image](https://hackmd.io/_uploads/BJJflrjrWg.png)

> 1) Boot SystemRescue using default options\
> æ­£å¸¸é–‹æ©Ÿé€² SystemRescueï¼ˆé è¨­åƒæ•¸ï¼‰
> 2) Boot SystemRescue and copy system to RAM (copytoram)\
> æ•´å€‹ live ç³»çµ±è¼‰å…¥åˆ°è¨˜æ†¶é«”å†å•Ÿå‹• (é–‹æ©Ÿå¾Œå¯ä»¥æ‹”æ‰ USB)
> 3) Boot SystemRescue and verify integrity of the medium (checksum)\
é–‹æ©Ÿå‰/é–‹æ©Ÿæ™‚åš media é©—è­‰ï¼ˆæ ¡é©— ISO/æª”æ¡ˆï¼‰
> 4) Boot SystemRescue using basic display drivers (nomodeset)\
> ç”¨åŸºæœ¬é¡¯ç¤ºæ¨¡å¼ï¼ˆç¦ç”¨é¡¯ç¤ºå¡ modesettingï¼‰
> 5) Boot a Linux operating system installed on the disk (findroot)\
ä¸é€² SystemRescueï¼Œè€Œæ˜¯æ‰¾ç¡¬ç¢Ÿä¸Šå·²å®‰è£çš„ Linux ä¸¦å˜—è©¦é–‹æ©Ÿ
> 6) Stop during the boot process before mounting the root filesystem\
é™¤éŒ¯ç”¨ï¼ˆé–‹æ©Ÿæ›è¼‰ root å¤±æ•—ã€æ‰‹å‹•æŸ¥ initramfsï¼‰
> 7) Boot existing OS\
ç›´æ¥è·³éé–‹å•ŸåŸæœ¬ç¡¬ç¢Ÿä¸Šçš„ä½œæ¥­ç³»çµ±
>8) Run Memtest86+ (RAM test)\
è·‘è¨˜æ†¶é«”æ¸¬è©¦
>9) Reboot 
>10) Power Off

### 3.2 SystemRescue CLI
é€²å…¥åˆ° SystemRescue CLI\
![image](https://hackmd.io/_uploads/SJjuMSoB-l.png)

é€é `lsblk` æŸ¥è©¢è¦æ¸…é™¤çš„å…§å»º SSD/NVMe
```
lsblk -o NAME,SIZE,MODEL,TYPE
```
(ç¯„ä¾‹)\
![image](https://hackmd.io/_uploads/rJ6ZXSjHbg.png)

æˆ– `nvme list` æŸ¥çœ‹
```
nvme list
```
(ç¯„ä¾‹)\
![image](https://hackmd.io/_uploads/HymaSHiHWg.png)


>[!Important]
>ç¬¦åˆ DoD 5220.22-M æˆ– NIST SP 800-88ï¼Œå…©æ¢ Wipe SSD è·¯å¾‘ï¼š
> - [NIST 800-88](https://csrc.nist.gov/pubs/sp/800/88/r2/final)ï¼šä½¿ç”¨ Purgeï¼ˆSanitize/Crypto-Erase/Block-Eraseï¼‰ï¼Œæˆ– Clearï¼ˆè¦†å¯«ï¼‰
> - [DoD 5220.22-M](https://www.dau.edu/sites/default/files/Migrated/CopDocuments/DoD%205220.22%20M%20NISPOM%2020060228.pdf)ï¼šç”¨ nwipe çš„ DoD 3-pass / 7-pass é¸é …å¤šæ¬¡è¤‡å¯«

### 3.3 (Option 1) DoD 5220.22-M
ä»¥ DoD 5220.22-M ç‚ºä¾‹ï¼Œåœ¨ Terminal ä½¿ç”¨ nwipe
```
sudo nwipe
```
é€²å…¥ nwipe ä»‹é¢ï¼Œå¯é¸æ“‡è¦æ¸…é™¤çš„ç¡¬ç¢Ÿ
![image](https://hackmd.io/_uploads/Sy8uPBsSbl.png)

- Print `m` : method\
å¯é¸æ“‡ Wipe Method (æŠ¹é™¤æ–¹æ³•/æ¼”ç®—æ³•)\
![wipe method](https://hackmd.io/_uploads/H1RG_BjrWe.jpg)

- Print `p`: PRNG / Pattern\
è¨­å®šéš¨æ©Ÿè³‡æ–™çš„ç”¢ç”Ÿå™¨ï¼ˆPRNGï¼‰æˆ–å¯«å…¥ patternçš„ç´°ç¯€\
é¡¯ç¤º Pseudo Random Number Generator
![image](https://hackmd.io/_uploads/Bkv0rDsBZl.png)
> ğŸ¥š å› ç‚º DoD method æ¯ä¸€è¼ªéƒ½æ˜¯å›ºå®š patternï¼ˆ0x00/0xFF/éš¨æ©Ÿï¼‰ï¼Œè‹¥åŒ…å« random passï¼Œæ‰æœƒç”¨åˆ°è¨­å®šçš„ PRNG

- Print `v`: Verify\
è¨­å®šé©—è­‰ç­–ç•¥ï¼Œå¸¸è¦‹ï¼šNo Pass / Last Pass / All Passes

- Print `c`: Config / Options\
å…¨åŸŸé¸é …åŒ…å« System Date & Time è¨­å®šã€å¯ä»¥å°‡ Wipe éç¨‹åŒ¯å‡ºæˆ PDF Report

ä¸Šè¿°å…§å®¹è¨­å®šå®Œå¾Œé»æ“Š `SHIFT + S` é–‹å§‹æŠ¹é™¤ ï¼ˆå¦‚åœ–ï¼‰\
![image](https://hackmd.io/_uploads/Bk1WiHjrbl.png)

### 3.4 (Option 2) NIST SP 800-88
è‹¥è¦ç¬¦åˆ NIST SP 800-88 å¯åˆ©ç”¨ NVMe Sanitize åŸ·è¡Œ Purge
>[!Tip]
> NVMe managementï¼š\
> https://github.com/linux-nvme/nvme-cli 

```
sudo nvme sanitize /dev/<disk name> -a 4
sudo nvme sanitize /dev/<disk name> -a 2
```
> - `-a 4`: Crypto Eraseï¼ˆåŠ å¯†æŠ¹é™¤ï¼‰
> - `-a 2`: Block Erase (è‹¥ SSD ä¸æ”¯æ´ crypto erase)

æŸ¥çœ‹æŠ¹é™¤é€²åº¦ï¼š
```
sudo nvme sanitize-log /dev/nvme0
```
> è®€å– NVMe çš„ Sanitize Log Pageï¼ŒæŸ¥çœ‹åŸ·è¡Œé€²åº¦

è©³ç´° nvme æ“ä½œå¯åƒè€ƒï¼š[manpages](https://manpages.debian.org/testing/nvme-cli/)


## 4. æŠ¹é™¤å®Œæˆ âœ…
